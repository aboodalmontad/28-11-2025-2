
<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>مكتب المحامي</title>
    <link rel="manifest" href="./manifest.json">
    <link rel="icon" href="./icon.svg" type="image/svg+xml">
    <meta name="theme-color" content="#1f2937">
    
    <!-- Google Fonts - Preconnect for speed -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS Play CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
      tailwind.config = {
        corePlugins: {
          preflight: true,
        },
        theme: {
          extend: {
            fontFamily: {
              sans: ['Tajawal', 'ui-sans-serif', 'system-ui', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif'],
            },
            animation: {
              'fade-in': 'fade-in 0.5s ease-out forwards',
            }
          },
        },
      }
    </script>

    <style type="text/tailwindcss">
      @layer base {
        body {
          @apply bg-gray-100 text-gray-900 antialiased;
          font-family: 'Tajawal', sans-serif;
        }
      }
      
      @keyframes fade-in {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
      }

      /* Loader Overlay Styles */
      #initial-loader {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: #f9fafb;
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: center;
          z-index: 9999;
          transition: opacity 0.4s ease-out, visibility 0.4s;
      }
      
      .spinner {
          width: 45px;
          height: 45px;
          border: 3px solid #e5e7eb;
          border-top: 3px solid #2563eb;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
      }
      
      @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
      }

      /* Safe Fade-out when React is ready */
      .app-ready #initial-loader {
          opacity: 0;
          visibility: hidden;
          pointer-events: none;
      }
      
      @media print {
        .no-print { display: none !important; }
      }
    </style>
    
    <!-- Import Map -->
    <script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.20.0",
    "@supabase/supabase-js": "https://esm.sh/@supabase/supabase-js@^2.44.4",
    "react/": "https://esm.sh/react@^19.1.1/",
    "react": "https://esm.sh/react@^19.1.1",
    "react-dom/": "https://esm.sh/react-dom@^19.1.1/",
    "react-dom/client": "https://esm.sh/react-dom@^19.1.1/client",
    "recharts": "https://esm.sh/recharts@^2.12.7",
    "idb": "https://esm.sh/idb@^8.0.0",
    "docx-preview": "https://esm.sh/docx-preview@^0.1.20"
  }
}
</script>
  </head>
  <body>
    <div id="initial-loader">
        <div class="spinner"></div>
        <p style="margin-top: 1rem; color: #4b5563; font-weight: 600; font-size: 0.875rem;">جاري تشغيل المكتب...</p>
    </div>
    
    <!-- The root element for React -->
    <div id="root"></div>
    
    <!-- Main script -->
    <script type="module" src="./index.js"></script>
    
    <script>
      // MutationObserver to detect when the app is rendered and hide the loader
      const root = document.getElementById('root');
      const observer = new MutationObserver((mutations) => {
        if (root.children.length > 0) {
          document.body.classList.add('app-ready');
          observer.disconnect();
        }
      });
      observer.observe(root, { childList: true });
    </script>
  </body>
</html>
